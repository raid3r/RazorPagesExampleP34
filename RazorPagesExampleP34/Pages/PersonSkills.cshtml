@page
@model RazorPagesExampleP34.Pages.PersonSkillsModel
@{
    var person = Model.Person;
    ViewData["Title"] = $"Skills of {person.FirstName} {person.LastName}";
    var skills = Model.Skills;

    var afterDeleteMessage = ViewData["AfterDeleteMessage"];
}


<h1>@ViewData["Title"]</h1>

<div class="mt-3 mb-3">
    <a class="btn btn-primary" asp-page="/SkillCreate" asp-route-personId="@person.Id">Create New Skill for person</a>
</div>


<table class="table table-hover">
    <thead>
        <tr>
            <th>Slill</th>
            <th>Level</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var skill in skills)
        {
            <tr>
                <td>@skill.Title</td>
                <td>
                    <div class="progress" style="max-width: 300px;">
                        <div class="progress-bar progress-bar-striped" role="progressbar" style="width: @skill.Proficiency%" aria-valuenow="@skill.Proficiency" aria-valuemin="0" aria-valuemax="100">
                            @skill.Proficiency %
                        </div>
                    </div>
                </td>
                <td>
                    <div class="button-container">
                        <a class="btn btn-warning" asp-page="/SkillEdit" asp-route-personId="@person.Id" asp-route-id="@skill.Id">Edit</a>
                        <form class="confirm-delete" method="post" asp-route-personId="@person.Id" asp-route-id="@skill.Id">
                            <button class="btn btn-danger" type="submit">Delete</button>
                        </form>
                    </div>

                </td>
            </tr>
        }
    </tbody>
</table>
<a class="btn btn-primary" asp-page="/People">Back to People List</a>


@section HeadScripts {
    
}

@section Scripts {
    <script src="~/js/confirm-delete.js" asp-append-version="true"></script>

    <script>
        function showAfterDeleteMessage() {
            Swal.fire({
                position: "top-end",
                icon: "success",
                title: "@afterDeleteMessage",
                showConfirmButton: false,
                timer: 1500
            });
         }

    @(afterDeleteMessage != null ? "showAfterDeleteMessage();" : "")
    </script>
}
